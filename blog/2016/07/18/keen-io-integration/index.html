<!doctype html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Web Card</title>

  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">


<style>
body {
	padding-top: 2em;
}

</style>


<!-- Latest compiled and minified JavaScript -->
  
  <script src="/jekyll-site/assets/js/zeroClipboard/ZeroClipboard.js"></script>
  
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.0/dist/bootstrap-toc.min.css">

<link rel="stylesheet" href="/jekyll-site/assets/site/css/toc.css">
<link rel="stylesheet" href="/jekyll-site/assets/site/css/customstyle.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/holder/2.9.3/holder.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/css/lightbox.min.css">
<!-- <link rel="stylesheet" href="/jekyll-site/assets/site/css/materialdesignicons.bootstrap.css"> -->
<link rel="stylesheet" href="https://cdn.materialdesignicons.com/1.7.22/css/materialdesignicons.min.css">


<script src="https://cdnjs.cloudflare.com/ajax/libs/keen-js/3.4.1/keen.min.js" type="text/javascript"></script>

</head>

<body data-spy="scroll" data-target="#toc">
<div class="container">
<nav class = "navbar navbar-default" role = "navigation">
   <div class = "navbar-header">
      <button type = "button" class = "navbar-toggle" 
         data-toggle = "collapse" data-target = "#example-navbar-collapse">
         <span class = "sr-only">Toggle navigation</span>
         <span class = "icon-bar"></span>
         <span class = "icon-bar"></span>
         <span class = "icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/jekyll-site/">Web Card</a>
   </div>
   
   <div class = "collapse navbar-collapse" id = "example-navbar-collapse">
      <ul class="nav navbar-nav">
          <li >
              <a href="/jekyll-site/blog">Blog</a>
          </li>
          
                      
          <li >
              <a href="/jekyll-site/links/">Links</a>
          </li>
          
      </ul>
   </div>
   
</nav>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- add after bootstrap.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v0.4.0/dist/bootstrap-toc.min.js"></script>
      
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.8.2/js/lightbox.min.js"></script>
<script id="dsq-count-scr" src="//nolte-jekyll-site.disqus.com/count.js" async></script>

<div class="container">
<div class="row">
	<div class="col-sm-8" style="padding-right:20px; border-right: 1px solid #ccc;">
		<article class="post">
		  
		  <header>
  
  <h1 data-toc-skip class="title indent">Keen.io integration</h1>
  

    
  <div class="meta">
    



<time datetime="2016-07-18T12:31:11+00:00" pubdate><i class="mdi mdi-calendar"></i> July 18, 2016</time>
    <span><i class='mdi mdi-timer'></i> two minutes reading time</span>
    

  <span>
    <i class="mdi mdi-tag-multiple"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/jekyll-site/blog/categories/ci/'>ci</a>,</li>
      
        <li><a class='category' href='/jekyll-site/blog/categories/iot/'>iot</a>,</li>
      
        <li><a class='category' href='/jekyll-site/blog/categories/jekyll/'>jekyll</a>,</li>
      
    
    </ul>
  </span>

    
     <i class="mdi mdi-comment-text"></i>
      <a class='comments'
         href="#disqus_thread"
         >Comments</a>
    
  </div>

</header>


<div  id = "postContent">
  <p><a href="https://keen.io">Keen.io</a> dient als Analytics Service, zum aufzeichnen der anfallenden Daten.</p>
<ul>
<li><a href="https://developers.google.com/chart/interactive/docs/gallery/barchart#examples">Google Charts JS</a></li>
<li><a href="https://keen.io">keen.io</a></li>
</ul>

<a name="read-more"></a>

<h1>Analysieren von Git Commits</h1>

<p>
Auf GitHub wurden Webhooks eingerichtet, das bei jeden <code>git push</code> die Daten nach <a href="https://keen.io">Keen.io</a> publiziert. 
</p>

<a href="/jekyll-site/assets/images/ditaa/ditaa-3c9b7a7aa0f9f4c7ff78dacec9b566b4.png" data-lightbox="ditaa-3c9b7a7aa0f9f4c7ff78dacec9b566b4.png" data-title="ditaa-3c9b7a7aa0f9f4c7ff78dacec9b566b4.png"><img src="/jekyll-site/assets/images/ditaa/ditaa-3c9b7a7aa0f9f4c7ff78dacec9b566b4.png" class="img-responsive" alt="ditaa-3c9b7a7aa0f9f4c7ff78dacec9b566b4.png" data-lightbox /></a>

<p>Der Webhook für alle <code>git push</code> Events geht an folgende url:</p>
<pre>
<code>
https://api.keen.io/3.0/projects/{project}/events/commit?api_key={writeApiKey}
</code>
</pre>
<p>die Payload des Http Request ist unter der <a href="https://developer.github.com/v3/activity/events/types/#pushevent">GitHub Developer Doku</a> beschrieben.</p>

<h2>Push Events</h2>

<div class="row">
	<div class="col-sm-12"> 
	<p>Eine Zählung über alle <code>git push</code> Events.</p>
	<div id="git-push-count"></div>
	</div>
</div>	

<h2>This Site Push Events</h2>
<p>Eine Zählung über die <code>git push</code> Events, welche dieses Projekt betreffen.</p>
<div class="row">
	<div class="col-sm-4"> 
	<div id="git-jekyll-site-branch-push-count"></div>
	</div>
	<div class="col-sm-4">
	 <div id="git-jekyll-site-not-master-push-count"></div> 
	</div>
	<div class="col-sm-4">
	<div id="git-jekyll-site-master-push-count"></div> 
	</div>
</div>


<h2>Analysieren von Ci Builds</h2>

<div id="chart"></div>

<div id="chartBuildByBranch"></div>


<script>
$( document ).ready(function() {
	
	  var client = new Keen({
	      projectId: "578d609a80a7bd79bfd6cb0a",
	      readKey: "2c8b72bf508f6343758403cc99066b7bdc30aa6ae89a70873e263e33981d3b4e750140761d5a1600c49b752b4fc119c051c72ee036d4b770b7ae1a4f203829934cfc50b9066b752ec4d2871039e59252e147e9876e1a6ae86fc8111766988662"
	  });
	  Keen.ready(function(){
		    var el = document.getElementById("git-jekyll-site-master-push-count");
		    var chart = new Keen.Dataviz()
		        .el(el)
		        .chartType('metric')
		        .prepare();

		    var query = new Keen.Query("count", {
		        eventCollection: "commit",
		        filters: [
		        {
		            "operator": "eq",
		            "property_name": "repository.full_name",
		            "property_value": "nolte/jekyll-site"
		        },
		        {
		            "operator": "eq",
		            "property_name": "ref",
		            "property_value": "refs/heads/master"
		        }
		    ],
		        timeframe: "this_14_years",
		        timezone: "UTC"
		      });
		    
		    client.run(query, function(err, res){
		    	  if (err) {
		    	    chart.error(err.message);
		    	  }
		    	  else {
		    	    chart
		    	      .title("on master")
		    	      .parseRequest(this)
		    	      .render();
		    	  }
		    	});
		});
	  Keen.ready(function(){
		    var el = document.getElementById("git-jekyll-site-not-master-push-count");
		    var chart = new Keen.Dataviz()
		        .el(el)
		        .chartType('metric')
		        .prepare();

		    var query = new Keen.Query("count", {
		        eventCollection: "commit",
		        filters: [
		        {
		            "operator": "eq",
		            "property_name": "repository.full_name",
		            "property_value": "nolte/jekyll-site"
		        },
		        {
		            "operator": "ne",
		            "property_name": "ref",
		            "property_value": "refs/heads/master"
		        }
		    ],
		        timeframe: "this_14_years",
		        timezone: "UTC"
		      });
		    
		    client.run(query, function(err, res){
		    	  if (err) {
		    	    chart.error(err.message);
		    	  }
		    	  else {
		    	    chart
		    	      .title("not master")
		    	      .parseRequest(this)
		    	      .render();
		    	  }
		    	});
		});		  
	  Keen.ready(function(){
		    var el = document.getElementById("git-push-count");
		    var chart = new Keen.Dataviz()
		        .el(el)
		        .chartType('metric')
		        .prepare();

		    
		    client.run('git-push-count', function(err, res){
		    	  if (err) {
		    	    chart.error(err.message);
		    	  }
		    	  else {
		    	    chart
		    	      .title("Git Push Count")
		    	      .parseRequest(this)
		    	      .render();
		    	  }
		    	});
		});	
	  Keen.ready(function(){
		    var el = document.getElementById("git-jekyll-site-branch-push-count");
		    var chart = new Keen.Dataviz()
		        .el(el)
		        .chartType('table')
		        .prepare();

		    
		    client.run('git-jekyll-site-branch-push-count', function(err, res){
		    	  if (err) {
		    	    chart.error(err.message);
		    	  }
		    	  else {
		    	    chart
		    	      .parseRequest(this)
		    	      .render();
		    	  }
		    	});
		});	 

	  Keen.ready(function(){
		    var el = document.getElementById("chartBuildByBranch");
		    var chart = new Keen.Dataviz()
		        .el(el)
		        .chartType('barChart')
		        .height(400)
		        .prepare();

		    client.run('jekyll-site-ci-count-build-by-branch', function(err, res){
		       chart
		           .parseRequest(this)
		           .call(function(){
		               var ds, df, line;
		               ds = new google.visualization.arrayToDataTable(this.data());
		               
		               // Create and apply a formatter
		               df = new google.visualization.DateFormat({
		                   formatType: 'long', 
		                   timeZone: -4
		               });
		               df.format(ds, 0);
		               var options = {
		            	        title: 'Build Counts',
		            	        hAxis: {
		            	          title: 'Build Count for each Branch',
		            	          minValue: 0
		            	        },
		            	        vAxis: {
		            	          title: 'Numbers of Builds'
		            	        }
		            	      };
		               line = new google.visualization.ColumnChart(this.el());
		               line.draw(ds,options);
		           });
		    });
		});	  
	  
Keen.ready(function(){
    var el = document.getElementById("chart");
    var chart = new Keen.Dataviz()
        .el(el)
        .chartType('barChart')
        .height(400)
        .prepare();

    client.run('jekyll-site-ci-avarage-build-duration', function(err, res){
       chart
           .parseRequest(this)
           .call(function(){
               var ds, df, line;
               ds = new google.visualization.arrayToDataTable(this.data());
               
               // Create and apply a formatter
               df = new google.visualization.DateFormat({
                   formatType: 'long', 
                   timeZone: -4
               });
               df.format(ds, 0);
               var options = {
            	        title: 'Jekyll Site Ci Avarage Build Duration',
            	        hAxis: {
            	          title: 'Avarage Build Duration',
            	          minValue: 0
            	        },
            	        vAxis: {
            	          title: 'Ci System'
            	        }
            	      };
               line = new google.visualization.BarChart(this.el());
               line.draw(ds,options);
           });
    });
});  
});
</script>

</div>

		</article>
	</div>
	<div class="col-sm-4">
		<nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="toc" data-spy="affix" data-toggle="toc"></nav>
	</div>
	
</div>


<section id="disqus">
  <h3 class="indent title">Comments</h3>
  <div id="disqus_thread" aria-live="polite"><div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'nolte-jekyll-site'; // required: replace example with your forum shortname
	var disqus_developer = 1; // Comment out when the site is live
	var disqus_identifier = "/blog/2016/07/18/keen-io-integration/";

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script');
		dsq.type = 'text/javascript';
		dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>
	Please enable JavaScript to view the <a
		href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span
	class="logo-disqus">Disqus</span></a>
</div></div>
</section>

    
<script>
  $( document ).ready(function() {
	  $( '<div class="divider"></div>' ).insertAfter( "h1,h2,h3" );
    });
</script>
</div>
<div class="container">
	<footer class="footer">
	        <p>footer</p>
	</footer>
</div>



<script>
  $( document ).ready(function() {
	   
    });
 
    </script>
    
    <script>
    $(function () {
    	
        client = new ZeroClipboard($(".copy_btn"));
    })
</script>
</body>


</html>